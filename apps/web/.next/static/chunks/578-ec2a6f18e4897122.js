"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{1578:(e,t,n)=>{n.d(t,{A:()=>N});var l=n(9944),r=n(1428),a=n(4021),s=n(7122),i=n(4953),o=n(3302),c=n(1246),u=n(6624),d=n(6488),m=n(9356),h=n(3445);let p=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/hdri/venice_sunset_1k.hdr";return new Promise((l,r)=>{new h.Y().load(n,n=>{let r=new a.BdL(e);t.environment=r.fromEquirectangular(n).texture,n.dispose(),r.dispose(),l()},void 0,e=>r(e))})},f=["Water molecules are V-shaped with a 104.5\xb0 angle due to oxygen's electron configuration","The only two liquid elements at room temperature are mercury and bromine","A single teaspoon of gold can be beaten into a sheet covering 100 square feet","The electrons in a neon light move at about 2,000 kilometers per second","Diamonds and graphite are both pure carbon, just arranged differently","The human body contains enough carbon to make 900 pencils","Table salt (NaCl) crystals are perfect cubes at the microscopic level","Every atom in your body is billions of years old, created in ancient stars","Helium is the only element discovered in space before Earth","The copper in a penny could be drawn into a wire 30 miles long","Pure gold is so soft that it can be molded with bare hands","A bucket of water contains more atoms than there are buckets of water in the Atlantic Ocean","The average human exhales about 1kg of carbon dioxide per day","Hydrogen is the most abundant element in the universe, making up 75% of all matter by mass","The noble gases were once called 'inert' gases because they rarely react with other elements","Lightning creates ozone, which is why the air smells different after a thunderstorm","The acid in your stomach is strong enough to dissolve zinc","Gallium melts at just above room temperature (85.6\xb0F)","The only letter not appearing in the periodic table is the letter 'J'","A silicon atom is about 0.0000002 millimeters wide","Phosphorus was discovered by an alchemist looking for gold in urine","The first artificial element was technetium, created in 1937","Every breath you take contains at least one molecule from Julius Caesar's last breath","The electrons in a copper atom never touch those of other copper atoms","At room temperature, mercury is the only metal that is liquid","Glass is actually an amorphous solid, not a very slow-flowing liquid","The ozone layer is constantly being destroyed and replenished naturally","Soap molecules have a head that loves water and a tail that hates it","The same iron atoms in your blood can be found in rust","Hydrogen bonds are what make water 'sticky' and give it surface tension","The quantum tunneling effect helps make nuclear fusion possible in stars","Carbon dating works because cosmic rays maintain a steady level of Carbon-14 in the atmosphere","The color of a ruby and a sapphire comes from the same element: chromium","Fluorine is so reactive it can even set fire to water","A crystal of table salt contains equal numbers of sodium and chlorine atoms","The smell of rain comes from bacteria in the soil releasing chemicals called geosmin","Dry ice goes directly from a solid to a gas, skipping the liquid phase","The noble gas xenon can form compounds despite being 'inert'","The electrons in a chemical bond are shared, not transferred","The same carbon atoms in your body could have once been part of a dinosaur"],g=e=>{let{isVisible:t,showFacts:n=!0}=e,[a,s]=(0,r.useState)(0),[i,o]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{s(Math.floor(Math.random()*f.length))},[]),(0,r.useEffect)(()=>{if(!t)return;let e=setInterval(()=>{o(!0),setTimeout(()=>{let e;do e=Math.floor(Math.random()*f.length);while(e===a);s(e),o(!1)},800)},8e3);return()=>clearInterval(e)},[t,a]),(0,l.jsxs)("div",{className:"absolute inset-0 bg-black bg-opacity-75 z-20 flex flex-col items-center justify-center\n      transition-opacity duration-300 ".concat(t?"opacity-100":"opacity-0 pointer-events-none"),children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500 mb-8"}),n&&(0,l.jsx)("div",{className:"max-w-md px-6",children:(0,l.jsxs)("div",{className:"text-center transition-opacity duration-800 ".concat(i?"opacity-0":"opacity-100"),children:[(0,l.jsx)("p",{className:"text-lg text-gray-300 font-medium",children:"Did you know?"}),(0,l.jsx)("p",{className:"mt-2 text-gray-400",children:f[a]})]})})]})},v=null,y=[{id:"hydroxyl",name:"Hydroxyl",smarts:"[OX2H]",smiles:"[OH]",description:"Alcohol/phenol OH"},{id:"carbonyl",name:"Carbonyl",smarts:"[CX3]=[OX1]",smiles:"C=O",description:"C=O (ketone/aldehyde)"},{id:"carboxylate",name:"Carboxylate",smarts:"C(=O)[O-]",description:"Deprotonated carboxyl"},{id:"carboxylic_acid",name:"Carboxylic acid",smarts:"C(=O)O[H]",smiles:"OC=O",description:"COOH"},{id:"ester",name:"Ester",smarts:"C(=O)O[C;!H0]",smiles:"COOC",description:"Ester linkage"},{id:"amide",name:"Amide",smarts:"C(=O)N",smiles:"NC=O",description:"Amide linkage"},{id:"primary_amine",name:"Primary amine",smarts:"[NX3;H2;!$(NC=O)]",smiles:"N",description:"R-NH2"},{id:"secondary_amine",name:"Secondary amine",smarts:"[NX3;H1;!$(NC=O)]",smiles:"NC",description:"R2NH"},{id:"tertiary_amine",name:"Tertiary amine",smarts:"[NX3;H0;!$(NC=O)]",smiles:"N(C)C",description:"R3N"},{id:"nitro",name:"Nitro",smarts:"[$([NX3](=O)=O)]",smiles:"[N+](=O)[O-]",description:"NO2"},{id:"halogen",name:"Halogen",smarts:"[F,Cl,Br,I]",description:"Halogen atom"},{id:"aromatic_ring",name:"Aromatic ring",smarts:"a1aaaaa1",description:"Benzene-like ring"},{id:"aromatic_ring_kekule",name:"Aromatic ring (backup)",smarts:"C1=CC=CC=C1",smiles:"C1=CC=CC=C1",description:"Fallback for benzene-like rings encoded with alternating bonds"},{id:"aromatic_ring_aromatic_carbon",name:"Aromatic ring (aromatic carbons)",smarts:"c1ccccc1",smiles:"c1ccccc1",description:"Fallback for aromatic carbons ring"},{id:"imidazole_like",name:"Imidazole-like ring",smarts:"n1c[nH]c1",smiles:"n1c[nH]c1",description:"Generic five-membered heteroaromatic ring (approx.)"},{id:"purine_like",name:"Purine/Xanthine-like core",smarts:"n1c2ncnc2n1",smiles:"n1c2ncnc2n1",description:"Fused bicyclic heteroaromatic (approx.)"},{id:"imide_like",name:"Imide-like (dicarbonyl N)",smarts:"N(C=O)C=O",smiles:"N(C=O)C=O",description:"Two carbonyls on nitrogen (imide-like)"}],x=new Map;async function b(e){var t,l,r,a,s,i,o,c,u,d;let m="sdf:".concat(function(e){let t=0;for(let n=0;n<e.length;n++)t=31*t+e.charCodeAt(n)|0;return"".concat(t)}(e)),h=x.get(m);if(h)return h;let p=await (!v&&(v=Promise.all([n.e(914),n.e(676)]).then(n.bind(n,8149)).then(e=>{var t;return null!=(t=e.default)?t:e})),v),f=p.Molecule.fromMolfile(e);if("function"==typeof p.Molecule.prototype.ensureHelperArrays){let e=(p.Molecule.cHelperRings||0)|(p.Molecule.cHelperAromaticity||0);null==(t=f.ensureHelperArrays)||t.call(f,e)}let g=[],b=new Map;for(let e of y){let t;if("function"==typeof p.Molecule.fromSmarts)t=p.Molecule.fromSmarts(e.smarts);else if(p.SmartsParser&&"function"==typeof p.SmartsParser.parse)t=p.SmartsParser.parse(e.smarts);else if(p.SmilesParser&&"function"==typeof p.SmilesParser.parse)try{t=p.SmilesParser.parse(e.smarts)}catch(e){t=null}if(!t)continue;let n=[];try{let e=new p.SSSearcherWithIndex;e.setFragment(t),e.setMolecule(f);let s=null!=(a=null==(l=e.findMatches)?void 0:l.call(e))?a:null==(r=e.search)?void 0:r.call(e);if(Array.isArray(s))for(let e of s)Array.isArray(e)&&n.push(e)}catch(e){try{let e=new p.SSSearcher;null==(s=e.setMol)||s.call(e,f),null==(i=e.setMolecule)||i.call(e,f),null==(o=e.setFragment)||o.call(e,t);let l=null!=(d=null==(c=e.findMatches)?void 0:c.call(e))?d:null==(u=e.search)?void 0:u.call(e);if(Array.isArray(l))for(let e of l)Array.isArray(e)&&n.push(e);else if(l&&"number"==typeof l.length&&"function"==typeof l.get)for(let e=0;e<l.length;e++){let t=l.get(e),r=[];for(let e=0;e<t.length;e++)r.push(t[e]);n.push(r)}}catch(e){}}if(n.length>0){let t=new Set;n.forEach(e=>e.forEach(e=>t.add(e)));let l={id:e.id,name:e.name,atoms:Array.from(t.values()),smarts:e.smarts,description:e.description};g.push(l),l.atoms.forEach(e=>{let t=b.get(e)||[];t.push(l.id),b.set(e,t)})}}let w={groups:g,atomToGroupIds:b};return x.set(m,w),w}let w=(e,t)=>{if(e.length<3)return{min:[0,0,0],max:[0,0,0],c:[0,0,0],r:0};let n=e[0],l=e[1],r=e[2],a=e[0],s=e[1],i=e[2],o=0,c=0;for(let t=3;t<e.length;t+=3){let n=e[t]-e[0],l=e[t+1]-e[1],r=e[t+2]-e[2],a=n*n+l*l+r*r;a>c&&(c=a,o=t)}let u=0;c=0;let d=e[o],m=e[o+1],h=e[o+2];for(let t=0;t<e.length;t+=3){let n=e[t]-d,l=e[t+1]-m,r=e[t+2]-h,a=n*n+l*l+r*r;a>c&&(c=a,u=t)}let p=(d+e[u])*.5,f=(m+e[u+1])*.5,g=(h+e[u+2])*.5,v=.5*Math.sqrt(c);for(let o=0;o<e.length;o+=3){let c=e[o],u=e[o+1],d=e[o+2];c<n&&(n=c),u<l&&(l=u),d<r&&(r=d),c>a&&(a=c),u>s&&(s=u),d>i&&(i=d);let m=c-p,h=u-f,y=d-g,x=Math.hypot(m,h,y),b=0;if(t&&(b=t[o/3]),x+b>v){let e=(v+x+b)*.5,t=(e-v)/x;p+=m*t,f+=h*t,g+=y*t,v=e}}return{min:[n,l,r],max:[a,s,i],c:[p,f,g],r:v}};function A(e,t,n){e.setColorAt(t,n),e.instanceColor&&(e.instanceColor.needsUpdate=!0)}function C(e,t){var n;let l=null==(n=e.userData)?void 0:n.baseColors;if(!l)return;let r=l[3*t+0],s=l[3*t+1],i=l[3*t+2],o=new a.Q1f(r,s,i);e.setColorAt(t,o),e.instanceColor&&(e.instanceColor.needsUpdate=!0)}function N(e){let{isLoading:t=!1,pdbData:n,sdfData:h,title:f,showAnnotations:v=!0,moleculeInfo:y,enableRibbonOverlay:x=!1,enableHoverPause:N=!0,enableHoverGlow:j=!1,showHoverDebug:M=!1,showDebugWireframe:E=!1,moleculeType:S,onHoverAtom:F,onSelectAtom:I,onFirstFrameRendered:k,enableInteraction:R=!0}=e,D=(0,r.useRef)(null),T=(0,r.useRef)(null),P=(0,r.useRef)(null),_=(0,r.useRef)(null),[z,H]=(0,r.useState)(!1),[O,B]=(0,r.useState)(!1),[L,q]=(0,r.useState)(!1),[G,Y]=(0,r.useState)(null),[X,W]=(0,r.useState)(!1),V=(0,r.useRef)(null),Z=(0,r.useRef)(null),U=(0,r.useRef)(null),Q=(0,r.useRef)(0),$=(0,r.useRef)(null),J=(0,r.useRef)(0),K=(0,r.useRef)(0),ee=(0,r.useRef)(!1),et=(0,r.useRef)(!1),en=(0,r.useRef)(v),el=(0,r.useRef)(null),er=(0,r.useRef)(null),ea=(0,r.useRef)(!1),es=(0,r.useRef)(!1),ei=(0,r.useRef)(void 0);(0,r.useEffect)(()=>{en.current=v},[v]),(0,r.useEffect)(()=>{var e,t,n,l;let r=null==(e=U.current)?void 0:e.domElement;if(!r)return;r.style.display=v?"":"none";let a=null==(l=Z.current)||null==(n=l.domElement)||null==(t=n.parentElement)?void 0:t.querySelector(".labels-group");a&&(a.style.display=v?"":"none")},[v]),(0,r.useEffect)(()=>{let e,l,r,f,g,y,A,C,N,j,M;if(t)return;let F={enableAnnotations:en.current},I=()=>{if(!_.current||!D.current||!P.current)return;let t=_.current.getBoundingClientRect(),n=t.width,a=t.height;e.aspect=n/a,e.updateProjectionMatrix(),r.setSize(n,a,!1),r.domElement.style.width="100%",r.domElement.style.height="100%",g&&g.setSize(n,a),en.current&&f&&(f.setSize(n,a),f.domElement.style.width="100%",f.domElement.style.height="100%"),g?g.render():r.render(l,e),en.current&&f&&f.render(l,e)},k=()=>{r&&l&&e&&(null==A||A.update(),g?g.render():r.render(l,e),en.current&&f&&f.render(l,e))},R=async()=>{let t=D.current,n=P.current,i=_.current;if(!t||!n||!i)return;let m=i.getBoundingClientRect();(m.width<2||m.height<2)&&await new Promise(e=>{let t=new ResizeObserver(n=>{var l;let r=null==(l=n[0])?void 0:l.contentRect;r&&r.width>=2&&r.height>=2&&(t.disconnect(),e())});t.observe(i)}),$.current=new a.zD7,(l=new a.Z58).background=new a.Q1f(1581627),ed.current=l;let h=i.getBoundingClientRect();(e=new a.ubm(50,h.width/h.height,1,5e3)).position.z=800,eu.current=e,l.add(new a.$p8(0xffffff,.6));let v=new a.dth(0xffffff,526368,.7);l.add(v);let x=new a.ZyN(0xffffff,1.2);x.position.set(1,1,1),l.add(x);let b=new a.ZyN(0xffffff,.8);b.position.set(-1,-1,1),l.add(b),C=new a.YJl,N=new a.YJl,C.add(N),l.add(C),em.current=C,"outputColorSpace"in(r=new a.JeP({antialias:!0}))?r.outputColorSpace=a.er$:r.outputEncoding=a.S2Q,r.toneMapping=a.FV,r.toneMappingExposure=1.1,r.physicallyCorrectLights=!0,r.setPixelRatio(window.devicePixelRatio);try{r.setSize(t.clientWidth,t.clientHeight)}catch(e){}try{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(r.domElement)}catch(e){}p(r,l).catch(()=>{}),g=new c.s(r);try{g.setSize(t.clientWidth,t.clientHeight)}catch(e){}let w=new u.A(l,e);if(g.addPass(w),y=new d.G(new a.I9Y(t.clientWidth,t.clientHeight),l,e),g.addPass(y),el.current=g,er.current=y,_.current){let e=_.current.querySelector(".molecule");e&&(e.style.display="none")}if(en.current){f=new o.B;try{f.setSize(n.clientWidth,n.clientHeight)}catch(e){}f.domElement.style.position="absolute",f.domElement.style.top="0px",f.domElement.style.pointerEvents="none";try{n.appendChild(f.domElement)}catch(e){}}(A=new s.N(e,r.domElement)).minDistance=400,A.maxDistance=1200,A.enableDamping=!0,A.dampingFactor=.05,A.enablePan=!1,(M=new ResizeObserver(e=>{requestAnimationFrame(()=>{I()})})).observe(i),I();try{r.domElement.style.visibility="hidden"}catch(e){}try{let e=_.current;e.style.pointerEvents,e.style.pointerEvents="none",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.pointerEvents="auto"})})}catch(e){}z(),Z.current=r,U.current=f},z=()=>{C&&(C.clear(),C.add(N),C.position.set(0,0,0),C.rotation.set(0,0,0)),ea.current=!1,A.reset(),V.current=null;let t=h&&h.trim().length>0,l=n&&n.trim().length>0,s=function(e,t,n){let l=e&&e.trim().length>0,r=t&&t.trim().length>0;return"macromolecule"===n?l?"PDB":"SDF":r?"SDF":"PDB"}(n,h,S);if(console.log("=== SMART FORMAT SELECTION ==="),console.log("Molecule type:",S),console.log("PDB available:",l),console.log("SDF available:",t),console.log("Selected format:",s),"SDF"===s){console.log("=== ATTEMPTING SDF LOADING ===");console.log("SDF data source:","Direct SDF"),console.log("SDF data available:",!!h),console.log("SDF data length:",null==h?void 0:h.length);try{let t=(0,m.MJ)(h,{showHydrogen:!0,addThreeCenterBonds:!1,layout:"auto",renderMultipleBonds:!0,attachAtomData:!0,attachProperties:!0});try{var c,u,d,p;let e=null==t||null==(c=t.userData)?void 0:c.loadResult;if(e&&e.mappings&&e.mappings.instancedAtoms){let n=e.mappings.instancedAtoms;ex.current={instanced:{mesh:n.mesh,instanceToAtomIndex:n.instanceToAtomIndex},atoms:null!=(p=null==t||null==(d=t.userData)||null==(u=d.chemistry)?void 0:u.atoms)?p:[]},(null==n?void 0:n.mesh)&&(n.mesh.userData.role="atomsInstanced")}else{let e=new Map,n=[],l=0;t.traverse(t=>{let r=t.userData;if(t.isMesh&&(null==r?void 0:r.atom)){let a="number"==typeof r.atom.index?r.atom.index:l++;e.set(t.uuid,a),n[a]={index:a,element:r.atom.symbol},t.userData.role="atom"}}),ex.current={meshUuidToAtomIndex:e,atoms:n}}}catch(e){ex.current=null}!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=new a.Pq0,l=0;e.traverse(e=>{var t;e.isMesh&&(null==(t=e.geometry)?void 0:t.type)==="SphereGeometry"&&(n.add(e.position),l++)}),n.divideScalar(l||1);let r=["Na","Li","K","Cl","Br","F","Ca","Mg"],s=[];e.traverse(e=>{var l,a;if(!e.isMesh)return;let i=null==(a=e.userData)||null==(l=a.atom)?void 0:l.symbol;i&&r.includes(i)&&e.position.distanceTo(n)>t&&s.push(e)}),s.forEach(e=>{e.parent&&e.parent.remove(e)})}(t);let n=0,l=0,s=[],i=[];if(t.traverse(e=>{var t,r,a,o,c,u;e.isMesh&&(null==(t=e.geometry)?void 0:t.type)==="SphereGeometry"&&(n++,(null==(c=e.userData)||null==(o=c.atom)?void 0:o.symbol)&&s.push(e.userData.atom.symbol)),(e.isLineSegments||e.isLine||e.isMesh&&((null==(r=e.geometry)?void 0:r.type)==="CylinderGeometry"||(null==(a=e.geometry)?void 0:a.type)==="BufferGeometry"))&&(l++,e.isLineSegments?i.push("LineSegments"):e.isLine?i.push("Line"):e.isMesh&&i.push("Mesh(".concat(null==(u=e.geometry)?void 0:u.type,")")))}),n>1&&0===l)throw C.clear(),Error("SDF bonds missing - fallback to PDB");t.traverse(e=>{if(e.isMesh){var t,n,l;let r=null!=(l=null==(n=e.material.color)||null==(t=n.clone)?void 0:t.call(n))?l:new a.Q1f(0xffffff);e.material=new a._4j({color:r,metalness:.3,roughness:.25,envMapIntensity:1})}});let f=new a.YJl;if(f.add(t),C.add(f),"2d"===t.userData.layoutMode&&e.position.set(0,0,800),A.enableRotate=!0,A.maxPolarAngle=Math.PI,A.minPolarAngle=0,v){let e=[];t.traverse(t=>{var n,l;t.isMesh&&(null==(l=t.userData)||null==(n=l.atom)?void 0:n.symbol)&&e.push(t.userData.atom.symbol)});let n=0;t.traverse(t=>{var l,r;if(!t.isMesh||!(null==(l=t.userData)?void 0:l.atom))return;let a=null!=(r=e[n++])?r:"";if(!a)return;let s=document.createElement("div");s.className="atom-label",s.textContent=a;let{r:i,g:c,b:u}=t.material.color,d=.2126*i+.7152*c+.0722*u>.45?"#000":"#fff";s.style.color=d,s.style.fontSize="12px",s.style.textShadow="0 0 4px ".concat("#000"===d?"#fff":"#000");let m=new o.v(s);m.position.set(0,0,0),t.add(m)})}f.scale.setScalar(120),f.updateMatrixWorld(!0);let g=(e=>{let t=[];e.updateMatrixWorld(!0);let n=new a.Pq0;return e.traverse(e=>{if(e.isMesh){var l,r;let a=!!(null==(l=e.userData)?void 0:l.atom),s=null==(r=e.geometry)?void 0:r.type;(a||"SphereGeometry"===s||"IcosahedronGeometry"===s)&&(e.getWorldPosition(n),t.push(n.x,n.y,n.z))}}),t.length>0?new Float32Array(t):null})(f);requestAnimationFrame(()=>{requestAnimationFrame(()=>{f.updateMatrixWorld(!0),g&&g.length>0?O(g):B();try{r.domElement.style.visibility=""}catch(e){}ea.current=!0,h&&h.trim().length>0?b(h).then(e=>{var t;eb.current=e,eS(((null==e||null==(t=e.groups)?void 0:t.length)||0)>0)}).catch(()=>{eb.current={groups:[],atomToGroupIds:new Map},eS(!1)}):(eb.current={groups:[],atomToGroupIds:new Map},eS(!1)),k()})}),N.visible=F.enableAnnotations,Y(null),H();return}catch(e){console.error("Failed to load SDF molecule:",e),console.error("SDF data length:",null==h?void 0:h.length),console.error("SDF data preview:",null==h?void 0:h.substring(0,200)),C.clear()}}let f=new Blob([n],{type:"text/plain"}),g=URL.createObjectURL(f);new i.c().load(g,e=>{var t,l,s;let{geometryAtoms:i,geometryBonds:c,json:u}=e,d=new a.iNn(1,1,1),m=new a.WBB(1,3),h=new a.Pq0;i.computeBoundingBox(),null==(t=i.boundingBox)||t.getCenter(h).negate(),i.translate(h.x,h.y,h.z),c.translate(h.x,h.y,h.z);let p=i.getAttribute("position"),f=i.getAttribute("color"),v=new a.Pq0,y=new a.Q1f,b=F.enableAnnotations&&p.count<=500;if(p.count<=5e3){for(let e=0;e<p.count;e++){v.set(p.getX(e),p.getY(e),p.getZ(e)),y.setRGB(f.getX(e),f.getY(e),f.getZ(e));let t=new a._4j({color:y,metalness:.3,roughness:.25,envMapIntensity:1}),n=new a.eaF(m,t);if(n.position.copy(v).multiplyScalar(120),n.scale.setScalar(40),n.userData.role="atom",n.userData.atom={index:e,symbol:null==(l=u.atoms[e])?void 0:l[4]},C.add(n),b&&u.atoms[e]){let t=u.atoms[e][4];if(t){let e=document.createElement("div");e.className="atom-label",e.textContent=t;let l=.2126*y.r+.7152*y.g+.0722*y.b>.45?"#000":"#fff";e.style.color=l,e.style.textShadow="0 0 4px ".concat("#000"===l?"#fff":"#000"),e.style.fontSize="14px",e.style.pointerEvents="none";let r=new o.v(e);r.position.copy(n.position),N.add(r)}}}p=c.getAttribute("position");let e=new a.Pq0,t=new a.Pq0;for(let n=0;n<p.count;n+=2){e.set(p.getX(n),p.getY(n),p.getZ(n)).multiplyScalar(120),t.set(p.getX(n+1),p.getY(n+1),p.getZ(n+1)).multiplyScalar(120);let l=new a.eaF(d,new a._4j({color:0xffffff,metalness:.1,roughness:.3,envMapIntensity:1}));l.position.copy(e).lerp(t,.5),l.scale.set(8,8,e.distanceTo(t)),l.lookAt(t),C.add(l)}}else if(p.count<=2e4){let e=((e,t,n,l,r,s,i)=>{let c=t.count,u=new a._4j({vertexColors:!0,metalness:.3,roughness:.25,envMapIntensity:1}),d=new a.ZLX(e,u,c);d.userData.role="atomsInstanced";let m=new a.B69,h=new a.Q1f,p=new Uint32Array(c),f=new Float32Array(3*c);for(let e=0;e<c;e++)if(m.position.set(t.getX(e),t.getY(e),t.getZ(e)).multiplyScalar(120),m.scale.setScalar(40),m.updateMatrix(),d.setMatrixAt(e,m.matrix),h.setRGB(n.getX(e),n.getY(e),n.getZ(e)),d.setColorAt(e,h),f[3*e+0]=h.r,f[3*e+1]=h.g,f[3*e+2]=h.b,p[e]=e,r&&l.atoms[e]){let t=l.atoms[e][4];if(t){let e=document.createElement("div");e.className="atom-label",e.textContent=t;let n=.2126*h.r+.7152*h.g+.0722*h.b>.45?"#000":"#fff";e.style.color=n,e.style.textShadow="0 0 4px ".concat("#000"===n?"#fff":"#000"),e.style.fontSize="14px",e.style.pointerEvents="none";let l=new o.v(e);l.position.copy(m.position),s.add(l)}}return d.instanceMatrix.needsUpdate=!0,d.instanceColor&&(d.instanceColor.needsUpdate=!0),d.userData.instanceToAtomIndex=p,d.userData.baseColors=f,i.add(d),{mesh:d,instanceToAtomIndex:p,baseColors:f}})(m,p,f,u,b,N,C);ey.current={mesh:e.mesh,instanceToAtomIndex:e.instanceToAtomIndex},p=c.getAttribute("position");let t=new a.Pq0,n=new a.Pq0;for(let e=0;e<p.count;e+=2){t.set(p.getX(e),p.getY(e),p.getZ(e)).multiplyScalar(120),n.set(p.getX(e+1),p.getY(e+1),p.getZ(e+1)).multiplyScalar(120);let l=new a.eaF(d,new a._4j({color:0xffffff,metalness:.1,roughness:.3,envMapIntensity:1}));l.position.copy(t).lerp(n,.5),l.scale.set(8,8,t.distanceTo(n)),l.lookAt(n),C.add(l)}}else((e,t,n,l,r)=>{let s=e.count;console.log("Building macromolecule visualization for ".concat(s," atoms"));let i=new a.YJl;i.name="macromolecule-visualization";let o=new a.LoY;o.setAttribute("position",e.clone()),o.setAttribute("color",t.clone()),o.scale(120,120,120);let c=document.createElement("canvas");c.width=c.height=128;let u=c.getContext("2d"),d=u.createRadialGradient(64,64,0,64,64,64);d.addColorStop(0,"rgba(255, 255, 255, 1.0)"),d.addColorStop(.3,"rgba(255, 255, 255, 0.8)"),d.addColorStop(.7,"rgba(128, 128, 128, 0.4)"),d.addColorStop(1,"rgba(0, 0, 0, 0.0)"),u.fillStyle=d,u.fillRect(0,0,128,128);let m=new a.GOR(c);m.generateMipmaps=!1,m.minFilter=a.k6q;let h=new a.BH$({size:s>5e4?25:35,vertexColors:!0,map:m,transparent:!0,opacity:.8,alphaTest:.1,sizeAttenuation:!0,blending:a.EZo}),p=new a.ONl(o,h);p.name="atom-points",i.add(p);let f=((e,t)=>{if(t<1e3)return null;let n=new a.YJl;n.name="protein-ribbon";let l=new Map;e.split("\n").forEach(e=>{if(e.startsWith("ATOM")){let t=e.substr(12,4).trim(),n=e.charAt(21)||"A";if(["CA","N","C"].includes(t)){let r=120*parseFloat(e.substr(30,8)),s=120*parseFloat(e.substr(38,8)),i=120*parseFloat(e.substr(46,8));l.has(n)||l.set(n,{ca:[],n:[],c:[]});let o=l.get(n),c=new a.Pq0(r,s,i);"CA"===t?o.ca.push(c):"N"===t?o.n.push(c):"C"===t&&o.c.push(c)}}});let r=0;return l.forEach((e,l)=>{if(!(e.ca.length<4))try{let s=new a.B6O(e.ca,!1,"centripetal",.5),i=new a.j6(s,Math.min(2*e.ca.length,200),t>5e4?8:12,8,!1),o=new a.Q1f().setHSL(r,.7,.6),c=new a._4j({color:o,transparent:!0,opacity:.7,metalness:.1,roughness:.3,envMapIntensity:1}),u=new a.eaF(i,c);u.name="ribbon-chain-".concat(l),n.add(u),r+=.15}catch(e){console.warn("Failed to create ribbon for chain ".concat(l,":"),e)}}),n.children.length>0?n:null})(n,s);f&&i.add(f);let g=((e,t)=>{if(t<2e3)return[];let n=[],l=[];return e.split("\n").forEach(e=>{if(e.startsWith("HELIX")){let t=e.charAt(19),l=parseInt(e.substr(21,4).trim()),r=parseInt(e.substr(33,4).trim());isNaN(l)||isNaN(r)||n.push({start:l,end:r,chainId:t})}else if(e.startsWith("SHEET")){let t=e.charAt(21),n=parseInt(e.substr(22,4).trim()),r=parseInt(e.substr(33,4).trim());isNaN(n)||isNaN(r)||l.push({start:n,end:r,chainId:t})}}),console.log("Found ".concat(n.length," helices and ").concat(l.length," beta sheets")),[]})(n,s);g.length>0&&g.forEach(e=>i.add(e));let v=((e,t,n)=>{let l=[],r=["HIS","CYS","ASP","GLU","SER","THR","TYR"],s=[];if(e.split("\n").forEach(e=>{if(e.startsWith("ATOM")){let t=e.substr(17,3).trim();if(r.includes(t)){let t=120*parseFloat(e.substr(30,8)),n=120*parseFloat(e.substr(38,8)),l=120*parseFloat(e.substr(46,8));s.push(new a.Pq0(t,n,l))}}}),s.length>10&&s.length<1e3){let e=new a.LoY,t=new Float32Array(3*s.length);s.forEach((e,n)=>{t[3*n]=e.x,t[3*n+1]=e.y,t[3*n+2]=e.z}),e.setAttribute("position",new a.THS(t,3));let n=new a.BH$({size:60,color:0xffaa00,transparent:!0,opacity:.6,sizeAttenuation:!0}),r=new a.ONl(e,n);r.name="active-sites",l.push(r)}return l})(n,0,0);return v.length>0&&v.forEach(e=>i.add(e)),l.add(i),r&&(r.selectedObjects=[i])})(p,f,n,C,er.current);x&&p.count>500&&((e,t)=>{let n=new Map;e.split("\n").forEach(e=>{if(e.startsWith("ATOM")&&"CA"===e.substr(12,4).trim()){let t=e.charAt(21).trim(),l=parseFloat(e.substr(30,8)),r=parseFloat(e.substr(38,8)),s=parseFloat(e.substr(46,8));n.has(t)||n.set(t,[]),n.get(t).push(new a.Pq0(l,r,s))}});let l=0;n.forEach(e=>{if(e.length<4)return;let n=new a.B6O(e.map(e=>e.clone().multiplyScalar(120)),!1,"centripetal",.5),r=new a.j6(n,4*e.length,12,6,!1),s=new a.Q1f().setHSL(l,.6,.5);l+=.3;let i=new a._4j({color:s,transparent:!0,opacity:.6,metalness:0,roughness:.5,envMapIntensity:1}),o=new a.eaF(r,i);t.add(o)})})(n,C);try{let e=((e,t)=>{let n=e.count,l=Math.floor(t.count/2);if(n>1e4)return{atomCount:n,bondCount:l};let r=[],s=new Map;for(let t=0;t<n;t++){let n=e.getX(t),l=e.getY(t),i=e.getZ(t);r.push(new a.Pq0(n,l,i)),s.set("".concat(n.toFixed(3),",").concat(l.toFixed(3),",").concat(i.toFixed(3)),t)}let i=Array.from({length:n},()=>[]),o=0;for(let e=0;e<t.count;e+=2){let n=t.getX(e),l=t.getY(e),r=t.getZ(e),c=t.getX(e+1),u=t.getY(e+1),d=t.getZ(e+1),m=new a.Pq0(n,l,r),h=new a.Pq0(c,u,d);o+=m.distanceTo(h);let p=s.get("".concat(n.toFixed(3),",").concat(l.toFixed(3),",").concat(r.toFixed(3))),f=s.get("".concat(c.toFixed(3),",").concat(u.toFixed(3),",").concat(d.toFixed(3)));void 0!==p&&void 0!==f&&(i[p].push(f),i[f].push(p))}let c=l?o/l:void 0,u=0,d=0;for(let e=0;e<n;e++){let t=i[e];if(!(t.length<2))for(let n=0;n<t.length;n++)for(let l=n+1;l<t.length;l++){let a=r[t[n]].clone().sub(r[e]),s=r[t[l]].clone().sub(r[e]),i=a.angleTo(s);!isNaN(i)&&(u+=i,d++)}}return{atomCount:n,bondCount:l,averageBondLength:c,averageBondAngle:d?u/d*(180/Math.PI):void 0}})(i.getAttribute("position"),c.getAttribute("position"));Y(e)}catch(e){Y(null)}URL.revokeObjectURL(g),N.visible=F.enableAnnotations;let A=new Float32Array(i.getAttribute("position").array);for(let e=0;e<A.length;e++)A[e]*=120;let j=w(A);i.boundingBox=new a.NRn(new a.Pq0(...j.min),new a.Pq0(...j.max)),i.boundingSphere=new a.iyt(new a.Pq0(...j.c),j.r),O(A),H();try{r.domElement.style.visibility=""}catch(e){}ea.current=!0,k(),es.current||(es.current=!0,null==(s=ei.current)||s.call(ei))})},H=()=>{T.current&&(T.current.style.display="",T.current.style.opacity="1",T.current.style.visibility="visible")},O=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.15,l=arguments.length>2?arguments[2]:void 0;if(!C||t.length<3)return;A.reset(),e.zoom=1,e.updateProjectionMatrix(),Q.current=0,K.current=0,C.rotation.set(0,0,0);let r=w(t,l),s=new a.Pq0(...r.c),i=r.r;C.children.forEach(e=>e.position.sub(s));let o=i*n/Math.sin(e.fov*Math.PI/180/2);e.position.set(0,0,o),e.near=.01*o,e.far=10*o,e.updateProjectionMatrix(),A.target.set(0,0,0),A.minDistance=.2*o,A.maxDistance=5*o,A.update(),A.saveState();let c={min:r.min.map((e,t)=>e-r.c[t]),max:r.max.map((e,t)=>e-r.c[t]),c:[0,0,0],r:r.r};return V.current=c,k(),c},B=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.15;if(!C)return;A.reset(),e.zoom=1,e.updateProjectionMatrix(),Q.current=0,K.current=0,C.rotation.set(0,0,0);let n=new a.iyt;new a.NRn().setFromObject(C).getBoundingSphere(n);let{center:l,radius:r}=n;C.children.forEach(e=>e.position.sub(l));let s=r*t/Math.sin(e.fov*Math.PI/180/2);e.position.set(0,0,s),e.near=.01*s,e.far=10*s,e.updateProjectionMatrix(),A.target.set(0,0,0),A.minDistance=.2*s,A.maxDistance=5*s,A.update(),A.saveState(),k()},L=()=>{if(j=requestAnimationFrame(L),C&&$.current){let e=$.current.getDelta();J.current=ee.current||et.current?0:.1,K.current+=(J.current-K.current)*.15,Q.current=(Q.current+K.current*e)%(2*Math.PI),C.rotation.y=Q.current}if(E&&l&&C&&V.current){let e=new a.iyt;if(e.center.set(...V.current.c),e.radius=V.current.r,C.updateMatrixWorld(!0),e.applyMatrix4(C.matrixWorld),ep.current){let t=ep.current.geometry;Math.abs(t.parameters.radius-e.radius)>.1&&(t.dispose(),ep.current.geometry=new a.Gu$(e.radius,32,16)),ep.current.position.copy(e.center)}else{let t=new a.Gu$(e.radius,32,16),n=new a.V9B({color:65280,wireframe:!0,transparent:!0,opacity:.6});ep.current=new a.eaF(t,n),l.add(ep.current)}}else ep.current&&l&&(l.remove(ep.current),ep.current.geometry.dispose(),ep.current.material.dispose(),ep.current=null);if(A.update(),ea.current&&(g?g.render():r.render(l,e),en.current&&f&&f.render(l,e),!es.current)){var t;es.current=!0,null==(t=ei.current)||t.call(ei)}};(async()=>{await R(),L()})();let q=e=>{e.detail&&e.detail.callback&&e.detail.callback(B)};window.addEventListener("request-fit-camera-function",q);let G=D.current,X=P.current,W=_.current;return()=>{var e,t,n,a,s,i,o;if(cancelAnimationFrame(j),null==M||M.disconnect(),C&&C.traverse(e=>{if(e.isMesh){var t,n;null==(t=e.geometry)||t.dispose(),Array.isArray(e.material)?e.material.forEach(e=>e.dispose()):null==(n=e.material)||n.dispose()}}),(null==r?void 0:r.domElement)&&(null==G?void 0:G.contains(r.domElement))&&G.removeChild(r.domElement),en.current&&(null==f?void 0:f.domElement)&&(null==X?void 0:X.contains(f.domElement))&&X.removeChild(f.domElement),null==r||r.dispose(),null==g||g.dispose(),null==A||A.dispose(),(null==l||null==(e=l.environment)?void 0:e.dispose)&&l.environment.dispose(),l&&(l.environment=null),null==l||l.clear(),window.removeEventListener("request-fit-camera-function",q),Z.current=U.current=el.current=er.current=eu.current=ed.current=em.current=null,null==(t=eh.current)||t.geometry.dispose(),null==(a=eh.current)||null==(n=a.material)||n.dispose(),eh.current=null,null==(s=ep.current)||s.geometry.dispose(),null==(o=ep.current)||null==(i=o.material)||i.dispose(),ep.current=null,W&&(W.style.pointerEvents="auto"),null==r?void 0:r.domElement){let e=r.domElement,t=e.__ml_evt_handlers__;t&&(e.removeEventListener("pointerdown",t.pointerdown),e.removeEventListener("pointermove",t.pointermove),e.removeEventListener("wheel",t.wheel),delete e.__ml_evt_handlers__)}Y(null)}},[t,n,h,S,x,v,N,j,E,f]);let eo=async()=>{if(_.current)try{document.fullscreenElement?(await document.exitFullscreen(),H(!1)):(await _.current.requestFullscreen(),H(!0))}catch(e){}},ec=()=>{ee.current=!ee.current,B(ee.current)},eu=(0,r.useRef)(null),ed=(0,r.useRef)(null),em=(0,r.useRef)(null),eh=(0,r.useRef)(null),ep=(0,r.useRef)(null),ef=(0,r.useRef)(new a.tBo),eg=(0,r.useRef)(new a.I9Y),ev=(0,r.useRef)(null),ey=(0,r.useRef)({mesh:null}),ex=(0,r.useRef)(null),eb=(0,r.useRef)(null),[ew,eA]=(0,r.useState)({visible:!1,x:0,y:0,text:""}),[eC,eN]=(0,r.useState)(!1),[ej,eM]=(0,r.useState)(!0),[eE,eS]=(0,r.useState)(!1),eF=(0,r.useRef)(null),eI=(0,r.useRef)(null);(0,r.useEffect)(()=>{ei.current=k},[k]);let ek=new a.Q1f(0xffd166),eR=new a.Q1f(6149022),eD=()=>{let e=ev.current;if(e){if("instanced"===e.kind&&null!=e.instanceId&&e.mesh&&e.mesh.isInstancedMesh)C(e.mesh,e.instanceId);else if("sdf-mesh"===e.kind&&e.mesh&&e.mesh.material){let t=e.mesh.material;t.emissive&&t.emissive.setRGB(0,0,0)}ev.current=null}},eT=()=>{if(eF.current){let{mesh:e,indices:t}=eF.current;for(let n of t)C(e,n);eF.current=null}if(eI.current){for(let e of eI.current){let t=e.material;t.emissive&&t.emissive.setRGB(0,0,0)}eI.current=null}},eP=e=>{if("instanced"===e.kind&&e.mesh&&null!=e.instanceId)A(e.mesh,e.instanceId,ek);else if("sdf-mesh"===e.kind&&e.mesh){let t=e.mesh.material;t.emissive&&t.emissive.set(ek)}ev.current=e},e_=(e,t)=>{var n,l,r,a;eT();let s=(null==(l=ex.current)||null==(n=l.instanced)?void 0:n.mesh)||ey.current.mesh||(t&&t.object.isInstancedMesh&&t.object?t.object:null);if(s){let n=s.userData&&s.userData.instanceToAtomIndex||ey.current.instanceToAtomIndex||(null==(a=ex.current)||null==(r=a.instanced)?void 0:r.instanceToAtomIndex),l=[];if(n)for(let t=0;t<n.length;t++)e.includes(n[t])&&l.push(t);else t&&t.object.isInstancedMesh&&null!=t.instanceId&&l.push(t.instanceId);for(let e of l)A(s,e,eR);eF.current={mesh:s,indices:l};return}let i=[];em.current&&em.current.traverse(t=>{var n;if(t.isMesh&&(null==(n=t.userData)?void 0:n.atom)&&"number"==typeof t.userData.atom.index){let n=t.userData.atom.index;if(e.includes(n)){let e=t.material;e.emissive&&e.emissive.set(eR),i.push(t)}}}),eI.current=i};return(0,r.useEffect)(()=>{et.current=X,j&&er.current&&(X?(er.current.selectedObjects=[em.current],er.current.edgeStrength=2.5,er.current.edgeGlow=.8,er.current.edgeThickness=1.5,er.current.pulsePeriod=0,er.current.visibleEdgeColor.setHex(0xffd700),er.current.hiddenEdgeColor.setHex(0xffa500)):er.current.selectedObjects=[])},[X,j]),(0,r.useEffect)(()=>{let e=()=>{H(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]),(0,r.useEffect)(()=>{let e=e=>{if("Space"===e.code){let t=document.activeElement;t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement||t&&"true"===t.getAttribute("contenteditable")||(e.preventDefault(),ec())}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,r.useEffect)(()=>{if(!_.current)return;let e=_.current;if(e.querySelectorAll(".molecule").forEach(e=>{e.style.display="none"}),!T.current){let t=document.createElement("div");t.className="molecule-title",e.appendChild(t),T.current=t}T.current.textContent=f,!t&&T.current&&(T.current.style.display="",T.current.style.opacity="1")},[f,t]),(0,r.useEffect)(()=>{T.current&&(L?(T.current.style.opacity="0",T.current.style.visibility="hidden"):(T.current.style.visibility="visible",T.current.style.opacity="1"))},[L]),(0,l.jsxs)("div",{ref:_,className:"relative w-full h-full rounded-xl overflow-hidden bg-[#050505] flex flex-col",onMouseMove:e=>{let n;if(!R||!D.current||!eu.current||!em.current||t||!Z.current||0===em.current.children.length)return;let l=D.current.getBoundingClientRect(),r=(e.clientX-l.left)/l.width*2-1,a=-(2*((e.clientY-l.top)/l.height))+1;eg.current.set(r,a),ef.current.setFromCamera(eg.current,eu.current);let s=ef.current.intersectObjects(em.current.children,!0);if(!s.length){eD(),eT(),W(!1),eA(e=>({...e,visible:!1}));return}for(let e of s){var i;let t=e.object;if((null==t?void 0:t.isInstancedMesh)||(null==t||null==(i=t.userData)?void 0:i.role)==="atom"){n=e;break}}if(!n){eD(),eT(),W(!1),eA(e=>({...e,visible:!1}));return}let o=(e=>{var t,n,l,r;let a=e.object.userData;if(e.object.isInstancedMesh&&null!=e.instanceId){let l=a&&a.instanceToAtomIndex||ey.current.instanceToAtomIndex||(null==(n=ex.current)||null==(t=n.instanced)?void 0:t.instanceToAtomIndex);if(l)return l[e.instanceId]}if("atom"===(null==a?void 0:a.role)){let t=a.atom;if(t&&"number"==typeof t.index)return t.index;let n=null==(r=ex.current)||null==(l=r.meshUuidToAtomIndex)?void 0:l.get(e.object.uuid);if("number"==typeof n)return n}})(n),c=(e=>{var t;if(null==e)return;let n=null==(t=ex.current)?void 0:t.atoms;if(n&&n[e])return n[e].element})(o),u=(e=>{var t,n,l;if(null==e)return[];let r=null==(t=eb.current)?void 0:t.atomToGroupIds,a=(null==r?void 0:r.get(e))||[];if(!(null==(l=eb.current)||null==(n=l.groups)?void 0:n.length))return[];let s=new Map(eb.current.groups.map(e=>[e.id,e.name]));return a.map(e=>s.get(e)||e)})(o);if(eD(),eT(),eC){if(!n)return;if(null!=o&&eb.current){let t=eb.current.atomToGroupIds.get(o)||[];if(t.length>0){let r=t[0],a=eb.current.groups.find(e=>e.id===r);a&&e_(a.atoms,n),W(!0),eA({visible:!0,x:e.clientX-l.left+12,y:e.clientY-l.top+12,text:a?"".concat(a.name):"Group",badges:a?[a.name]:[]});return}}}ej&&(n.object.isInstancedMesh&&null!=n.instanceId?eP({kind:"instanced",mesh:n.object,instanceId:n.instanceId}):eP({kind:"sdf-mesh",mesh:n.object})),W(!0),eA({visible:!0,x:e.clientX-l.left+12,y:e.clientY-l.top+12,text:c?"".concat(c," \xb7 #").concat(null!=o?o:"-"):"Atom #".concat(null!=o?o:"-"),badges:u})},onMouseLeave:()=>{R&&(eD(),eT(),W(!1),eA(e=>({...e,visible:!1})))},onClick:()=>{var e,t,n,l,r;if(!R)return;let a=ev.current;if(a){if("instanced"===a.kind&&null!=a.instanceId){let e=(null==(n=a.mesh)?void 0:n.userData)&&a.mesh.userData.instanceToAtomIndex||ey.current.instanceToAtomIndex||(null==(r=ex.current)||null==(l=r.instanced)?void 0:l.instanceToAtomIndex),t=e?e[a.instanceId]:void 0;"number"==typeof t&&(null==I||I([t]))}else if("sdf-mesh"===a.kind&&(null==(t=a.mesh.userData)||null==(e=t.atom)?void 0:e.index)!=null){let e=a.mesh.userData.atom.index;"number"==typeof e&&(null==I||I([e]))}}},children:[(0,l.jsx)(g,{isVisible:t,showFacts:!0}),!t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{ref:D,className:"absolute inset-0"}),(0,l.jsx)("div",{ref:P,className:"absolute inset-0 pointer-events-none"}),ew.visible&&(0,l.jsxs)("div",{className:"absolute z-30 text-xs px-2 py-1 rounded-md bg-black/75 text-white border border-white/10 pointer-events-none",style:{left:ew.x,top:ew.y},children:[(0,l.jsx)("div",{className:"font-medium",children:ew.text}),ew.badges&&ew.badges.length>0&&(0,l.jsx)("div",{className:"mt-1 flex flex-wrap gap-1",children:ew.badges.map((e,t)=>(0,l.jsx)("span",{className:"px-1.5 py-0.5 rounded bg-white/10",children:e},t))})]}),(0,l.jsxs)("div",{className:"absolute top-4 right-4 z-20 flex space-x-2",children:[(0,l.jsx)("button",{onClick:ec,className:"p-2 rounded-lg text-white hover:text-gray-300 transition-colors duration-200",title:O?"Play Animation":"Pause Animation",children:O?(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}):(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,l.jsx)("button",{onClick:()=>{q(!L)},className:"p-2 rounded-lg text-white hover:text-gray-300 transition-colors duration-200",title:L?"Hide Info":"Show Info",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-9-3a1 1 0 112 0 1 1 0 01-2 0zm2 8a1 1 0 11-2 0v-4a1 1 0 112 0v4z",clipRule:"evenodd"})})}),R&&eE&&(0,l.jsx)("button",{onClick:()=>{let e=!eC;eN(e),e||eT()},className:"p-2 rounded-lg transition-colors duration-200 ".concat(eC?"text-green-300":"text-white hover:text-gray-300"),title:eC?"Disable functional group mode":"Enable functional group mode",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-5 w-5",children:(0,l.jsx)("path",{d:"M12 2a1 1 0 011 1v1.06a7.003 7.003 0 015.94 5.94H20a1 1 0 110 2h-1.06a7.003 7.003 0 01-5.94 5.94V21a1 1 0 11-2 0v-1.06a7.003 7.003 0 01-5.94-5.94H4a1 1 0 110-2h1.06a7.003 7.003 0 015.94-5.94V3a1 1 0 011-1zm0 4a5 5 0 100 10A5 5 0 0012 6z"})})}),R&&(0,l.jsx)("button",{onClick:()=>{let e=!ej;eM(e),e||eD()},className:"p-2 rounded-lg transition-colors duration-200 ".concat(ej?"text-blue-300":"text-white hover:text-gray-300"),title:ej?"Disable atom highlight mode":"Enable atom highlight mode",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-5 w-5",children:(0,l.jsx)("circle",{cx:"12",cy:"12",r:"4"})})}),(0,l.jsx)("button",{onClick:eo,className:"p-2 rounded-lg text-white hover:text-gray-300 transition-colors duration-200",title:z?"Exit Fullscreen":"Enter Fullscreen",children:z?(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M5 9V7a2 2 0 012-2h2V3H7a4 4 0 00-4 4v2h2zm10 0V7a2 2 0 00-2-2h-2V3h2a4 4 0 014 4v2h-2zm-10 2H3v2a4 4 0 004 4h2v-2H7a2 2 0 01-2-2v-2zm10 0h2v2a4 4 0 01-4 4h-2v-2z",clipRule:"evenodd"})}):(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h4a1 1 0 010 2H6.414l2.293 2.293a1 1 0 11-1.414 1.414L5 6.414V8a1 1 0 01-2 0V4zm9 1a1 1 0 010-2h4a1 1 0 011 1v4a1 1 0 01-2 0V6.414l-2.293 2.293a1 1 0 11-1.414-1.414L13.586 5H12zm-9 7a1 1 0 012 0v1.586l2.293-2.293a1 1 0 111.414 1.414L6.414 15H8a1 1 0 010 2H4a1 1 0 01-1-1v-4zm13-1a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 010-2h1.586l-2.293-2.293a1 1 0 111.414-1.414L15 13.586V12a1 1 0 011-1z",clipRule:"evenodd"})})})]}),(y||eE)&&(0,l.jsxs)("div",{className:"absolute z-20 left-4 right-4 bottom-4 rounded-xl bg-black/60 backdrop-blur-md border border-white/10 shadow-2xl text-white text-sm sm:text-[13px] p-4 sm:p-5 transform-gpu transition-all duration-500 ease-out ".concat(L?"translate-y-0 opacity-100 pointer-events-auto":"translate-y-4 opacity-0 pointer-events-none"),children:[(0,l.jsxs)("div",{className:"mb-2",children:[(0,l.jsx)("div",{className:"text-[11px] uppercase tracking-[0.12em] text-white/60",children:"Molecule"}),(0,l.jsx)("div",{className:"text-base sm:text-lg font-semibold leading-tight",children:f})]}),(0,l.jsx)("div",{className:"h-px bg-white/10 my-3"}),(null==y?void 0:y.formula)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Formula:"})," ",null==y?void 0:y.formula]}),(null==y?void 0:y.formula_weight)&&"number"==typeof(null==y?void 0:y.formula_weight)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"MW:"})," ",null==y?void 0:y.formula_weight.toFixed(2)," kDa"]}),(null==y?void 0:y.canonical_smiles)&&(0,l.jsxs)("div",{className:"mb-1 break-all",children:[(0,l.jsx)("span",{className:"text-white/60",children:"SMILES:"})," ",null==y?void 0:y.canonical_smiles]}),(null==y?void 0:y.inchi)&&(0,l.jsxs)("div",{className:"mb-1 break-all",children:[(0,l.jsx)("span",{className:"text-white/60",children:"InChI:"})," ",null==y?void 0:y.inchi]}),(null==y?void 0:y.synonyms)&&(null==y?void 0:y.synonyms.length)>0&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Synonyms:"})," ",null==y?void 0:y.synonyms.slice(0,3).join(", ")]}),(null==y?void 0:y.full_description)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Description:"})," ",null==y?void 0:y.full_description]}),(null==y?void 0:y.resolution)&&"number"==typeof(null==y?void 0:y.resolution)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Resolution:"})," ",null==y?void 0:y.resolution.toFixed(1)," \xc5"]}),(null==y?void 0:y.experimental_method)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Method:"})," ",null==y?void 0:y.experimental_method]}),(null==y?void 0:y.chain_count)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Chains:"})," ",null==y?void 0:y.chain_count]}),(null==y?void 0:y.organism_scientific)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Source:"})," ",null==y?void 0:y.organism_scientific,(null==y?void 0:y.organism_common)&&" (".concat(null==y?void 0:y.organism_common,")")]}),(null==y?void 0:y.keywords)&&(null==y?void 0:y.keywords.length)>0&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Keywords:"})," ",null==y?void 0:y.keywords.join(", ")]}),(null==y?void 0:y.publication_year)&&(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("span",{className:"text-white/60",children:"Published:"})," ",null==y?void 0:y.publication_year,(null==y?void 0:y.publication_doi)&&(0,l.jsx)("a",{href:"https://doi.org/".concat(null==y?void 0:y.publication_doi),target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-300 hover:text-blue-400",children:"DOI"})]}),G&&(0,l.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-x-4 text-[11px]",children:[(0,l.jsxs)("div",{children:["Atoms: ",G.atomCount]}),(0,l.jsxs)("div",{children:["Bonds: ",G.bondCount]}),void 0!==G.averageBondLength&&(0,l.jsxs)("div",{className:"col-span-2",children:["Avg bond length: ",G.averageBondLength.toFixed(2)," \xc5"]}),void 0!==G.averageBondAngle&&(0,l.jsxs)("div",{className:"col-span-2",children:["Avg bond angle: ",G.averageBondAngle.toFixed(1),"\xb0"]})]}),eE&&eb.current&&eb.current.groups.length>0&&(0,l.jsxs)("div",{className:"mt-3",children:[(0,l.jsx)("div",{className:"text-[11px] uppercase tracking-[0.12em] text-white/60 mb-1",children:"Functional groups"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-1.5",children:eb.current.groups.map(e=>(0,l.jsx)("button",{className:"px-1.5 py-0.5 rounded bg-white/10 text-xs hover:bg-white/20 transition-colors",onClick:()=>{eN(!0),e_(e.atoms)},children:e.name},e.id))})]})]})]})]})}}}]);