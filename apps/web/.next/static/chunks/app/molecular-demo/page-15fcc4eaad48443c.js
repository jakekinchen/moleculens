(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{2827:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var l=t(9944),a=t(1428);function r(e){let{smiles:s,width:r=300,height:n=300,transparent:i=!1,atomLabels:c=!1,className:o="",onImageGenerated:d,onError:m}=e,x=(0,a.useRef)(null),[h,u]=(0,a.useState)(!0),[f,g]=(0,a.useState)(null),[b,j]=(0,a.useState)(null);return((0,a.useEffect)(()=>{if(!s){g("No SMILES data provided"),u(!1);return}(async()=>{u(!0),g(null);try{try{let e={svg:(await Promise.all([t.e(914),t.e(676)]).then(t.bind(t,8149))).Molecule.fromSmiles(s).toSVG(r,n,void 0,{suppressChiralText:!c,suppressESR:!0,suppressCIPParity:!0,noStereoProblem:!0}),width:r,height:n};j(e),d&&d(e)}catch(t){console.warn("OpenChemLib failed, using fallback:",t);let e={svg:'\n            <svg width="'.concat(r,'" height="').concat(n,'" viewBox="0 0 ').concat(r," ").concat(n,'" xmlns="http://www.w3.org/2000/svg">\n              <rect width="100%" height="100%" fill="').concat(i?"none":"white",'" stroke="#e5e7eb" stroke-width="1"/>\n              <circle cx="50%" cy="40%" r="20" fill="#3b82f6" opacity="0.2"/>\n              <text x="50%" y="30%" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#3b82f6" font-weight="bold">\n                2D Structure\n              </text>\n              <text x="50%" y="50%" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#6b7280">\n                Loading...\n              </text>\n              <text x="50%" y="70%" text-anchor="middle" font-family="monospace" font-size="8" fill="#9ca3af">\n                ').concat(s.length>40?s.substring(0,40)+"...":s,"\n              </text>\n            </svg>\n          "),width:r,height:n};j(e),d&&d(e)}}catch(s){let e=s instanceof Error?s.message:"Failed to generate 2D structure";g(e),m&&m(s instanceof Error?s:Error(e))}finally{u(!1)}})()},[s,r,n,i,c,d,m]),h)?(0,l.jsx)("div",{ref:x,className:"flex items-center justify-center bg-gray-100 rounded ".concat(o),style:{width:r,height:n},children:(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"Generating structure..."})}):f?(0,l.jsx)("div",{ref:x,className:"flex items-center justify-center bg-red-50 border border-red-200 rounded ".concat(o),style:{width:r,height:n},children:(0,l.jsxs)("div",{className:"text-sm text-red-600 text-center px-2",children:["Error: ",f]})}):(null==b?void 0:b.svg)?(0,l.jsx)("div",{ref:x,className:"overflow-hidden rounded ".concat(o),style:{width:r,height:n},children:(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:b.svg},className:"w-full h-full"})}):(0,l.jsx)("div",{ref:x,className:"flex items-center justify-center bg-gray-100 rounded ".concat(o),style:{width:r,height:n},children:(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"No structure available"})})}function n(e){let{smiles:s,name:t,formula:a,molecularWeight:n,properties:i,onViewDetails:c}=e;return(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 max-w-sm",children:(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)(r,{smiles:s,width:200,height:200,transparent:!0,atomLabels:!1,className:"mb-3"}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-center mb-2",children:t}),(0,l.jsxs)("div",{className:"text-sm text-gray-600 space-y-1 w-full",children:[a&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Formula:"}),(0,l.jsx)("span",{className:"font-mono",children:a})]}),n&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"MW:"}),(0,l.jsxs)("span",{children:["number"==typeof n?n.toFixed(2):n," ","g/mol"]})]}),i&&Object.entries(i).map(e=>{let[s,t]=e;return(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("span",{children:[s,":"]}),(0,l.jsx)("span",{children:t})]},s)})]}),c&&(0,l.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),c()},className:"mt-3 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"View Details"})]})})}var i=t(1578);function c(e){let{smiles:s,width:r=200,height:n=200}=e,[i,c]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[m,x]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{(async()=>{if(!s){d("No SMILES provided"),x(!1);return}x(!0),d("");try{console.log("Attempting to load OpenChemLib...");let e=await Promise.all([t.e(914),t.e(676)]).then(t.bind(t,8149));console.log("OpenChemLib loaded successfully"),console.log("Parsing SMILES:",s);let l=e.Molecule.fromSmiles(s);console.log("Molecule created successfully");let a=l.toSVG(r,n);console.log("SVG generated successfully"),c(a)}catch(e){console.error("Error generating structure:",e),d("Failed to generate structure: ".concat(e instanceof Error?e.message:"Unknown error")),c('\n          <svg width="'.concat(r,'" height="').concat(n,'" viewBox="0 0 ').concat(r," ").concat(n,'" xmlns="http://www.w3.org/2000/svg">\n            <rect width="100%" height="100%" fill="white" stroke="#ccc"/>\n            <text x="50%" y="30%" text-anchor="middle" font-size="12" fill="#666">Structure Error</text>\n            <text x="50%" y="50%" text-anchor="middle" font-size="10" fill="#999">').concat(s.substring(0,20),'...</text>\n            <text x="50%" y="70%" text-anchor="middle" font-size="8" fill="#ccc">OpenChemLib failed</text>\n          </svg>\n        '))}finally{x(!1)}})()},[s,r,n]),m)?(0,l.jsx)("div",{style:{width:r,height:n},className:"flex items-center justify-center bg-gray-100 border rounded",children:(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"Loading..."})}):(0,l.jsxs)("div",{className:"border rounded overflow-hidden",children:[o&&(0,l.jsx)("div",{className:"bg-red-50 border-b border-red-200 p-2",children:(0,l.jsx)("span",{className:"text-xs text-red-600",children:o})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:i},style:{width:r,height:n}})]})}let o=[{name:"Caffeine",smiles:"CN1C=NC2=C1C(=O)N(C(=O)N2C)C",formula:"C8H10N4O2",molecular_weight:194.19},{name:"Aspirin",smiles:"CC(=O)OC1=CC=CC=C1C(=O)O",formula:"C9H8O4",molecular_weight:180.16},{name:"Glucose",smiles:"C([C@@H]1[C@H]([C@@H]([C@H]([C@H](O1)O)O)O)O)O",formula:"C6H12O6",molecular_weight:180.16},{name:"Benzene",smiles:"C1=CC=CC=C1",formula:"C6H6",molecular_weight:78.11},{name:"Ethanol",smiles:"CCO",formula:"C2H6O",molecular_weight:46.07},{name:"Water",smiles:"O",formula:"H2O",molecular_weight:18.02}];function d(){let[e,s]=(0,a.useState)(null),[t,d]=(0,a.useState)(""),[m,x]=(0,a.useState)(null),[h,u]=(0,a.useState)(!1),[f,g]=(0,a.useState)(null),[b,j]=(0,a.useState)(!1),p=async()=>{if(t.trim()){u(!0),g(null),x(null);try{var e,s,l,a;let r=await fetch("/api/prompt/fetch-molecule-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})});if(!r.ok)throw Error("Search failed: ".concat(r.statusText));let n=await r.json();if(n.error)throw Error(n.error);let i=n.smiles||(null==(e=n.info)?void 0:e.canonical_smiles)||(null==(s=n.info)?void 0:s.isomeric_smiles)||"";x({name:n.name||t,smiles:i,formula:n.formula||(null==(l=n.info)?void 0:l.formula),molecular_weight:null==(a=n.info)?void 0:a.formula_weight,pdb_data:n.pdb_data,sdf_data:n.sdf})}catch(e){g(e instanceof Error?e.message:"Search failed")}finally{u(!1)}}},v=e=>{s(e),j(!1)};return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Client-Side Molecular Processing Demo"}),(0,l.jsx)("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"This demo showcases our new client-side molecular processing capabilities using OpenChemLib and direct PubChem API integration, eliminating the need for PyMOL server calls."})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Search Molecules"}),(0,l.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,l.jsx)("input",{type:"text",value:t,onChange:e=>d(e.target.value),placeholder:"Enter molecule name (e.g., caffeine, aspirin, glucose)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 bg-white",onKeyDown:e=>"Enter"===e.key&&p()}),(0,l.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),p()},disabled:h||!t.trim(),className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Searching...":"Search"})]}),f&&(0,l.jsxs)("div",{className:"text-red-600 mb-4",children:["Error: ",f]}),!1,m&&(0,l.jsxs)("div",{className:"border-t pt-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Search Result:"}),(0,l.jsx)(n,{smiles:m.smiles,name:m.name,...m.formula&&{formula:m.formula},...m.molecular_weight&&{molecularWeight:m.molecular_weight},onViewDetails:()=>v(m)})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Demo Molecules"}),(0,l.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(e=>(0,l.jsx)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)(c,{smiles:e.smiles,width:180,height:180}),(0,l.jsx)("h3",{className:"text-lg font-semibold mt-3 mb-2",children:e.name}),(0,l.jsxs)("div",{className:"text-sm text-gray-600 space-y-1 w-full",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"Formula:"}),(0,l.jsx)("span",{className:"font-mono",children:e.formula})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{children:"MW:"}),(0,l.jsxs)("span",{children:[e.molecular_weight," g/mol"]})]})]}),(0,l.jsx)("button",{type:"button",onClick:s=>{s.preventDefault(),v(e)},className:"mt-3 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"View Details"})]})},e.name))})]}),e&&(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsxs)("h2",{className:"text-xl font-semibold",children:[e.name," - Detailed View"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),j(!1)},className:"px-4 py-2 rounded-lg transition-colors ".concat(b?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-500 text-white"),children:"2D Structure"}),(0,l.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),j(!0)},className:"px-4 py-2 rounded-lg transition-colors ".concat(b?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),disabled:!e.pdb_data&&!e.sdf_data,children:"3D Structure"})]})," "]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsx)("div",{className:"flex justify-center",children:b?e.pdb_data||e.sdf_data?(0,l.jsx)("div",{className:"w-full h-96 bg-gray-900 rounded-lg",children:(0,l.jsx)(i.A,{pdbData:e.pdb_data||"",sdfData:e.sdf_data,title:e.name,showAnnotations:!0,enableHoverPause:!1,showDebugWireframe:!1})}):(0,l.jsx)("div",{className:"w-full h-96 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-gray-500 text-center",children:[(0,l.jsx)("p",{children:"3D structure not available"}),(0,l.jsx)("p",{className:"text-sm",children:"Try searching for the molecule to get 3D data"})]})}):(0,l.jsx)(r,{smiles:e.smiles,width:400,height:400,transparent:!1,atomLabels:!0,className:"border border-gray-200 rounded-lg"})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Molecular Information"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"font-medium",children:"Name:"}),(0,l.jsx)("span",{children:e.name})]}),e.formula&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"font-medium",children:"Formula:"}),(0,l.jsx)("span",{className:"font-mono",children:e.formula})]}),e.molecular_weight&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"font-medium",children:"Molecular Weight:"}),(0,l.jsxs)("span",{children:["number"==typeof e.molecular_weight?e.molecular_weight.toFixed(2):e.molecular_weight," ","g/mol"]})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"font-medium",children:"SMILES:"}),(0,l.jsx)("span",{className:"font-mono text-xs break-all max-w-xs",children:e.smiles})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Available Data"}),(0,l.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.smiles?"bg-green-500":"bg-red-500")}),(0,l.jsx)("span",{children:"2D Structure (SMILES)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.sdf_data?"bg-green-500":"bg-red-500")}),(0,l.jsx)("span",{children:"3D Structure (SDF)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.pdb_data?"bg-green-500":"bg-red-500")}),(0,l.jsx)("span",{children:"PDB Format"})]})]})]})]})]})]}),(0,l.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Client-Side Features"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Fast Performance"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"No server round-trips for basic molecular operations"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Direct API Access"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Direct integration with PubChem and RCSB PDB"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,l.jsx)("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 7.172V5L8 4z"})})}),(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Client-Side Processing"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"2D structure generation and format conversion"})]})]})]})]})})}},4213:(e,s,t)=>{Promise.resolve().then(t.bind(t,2827))}},e=>{e.O(0,[641,407,578,695,274,358],()=>e(e.s=4213)),_N_E=e.O()}]);